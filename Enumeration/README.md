<div id="top"></div>

  <h3 align="center">Enumeration</h3>

  <p align="center">
    Enumerating for OSCP exam
  </p>
</div>

<!-- ABOUT THE PROJECT -->
## General

<h4>General</h4>

Host discovery:

    sudo nmap -PEPM -sP -n -iL ipranges.txt

Always start with a quick port scan:

    nmap -p- -v -T4 ipaddress | use -Pn if the host does not respond.
    
Then start enumerating services:

    nmap -p 80,443,445 -sV -sC -Pn -v -T4
    
Also use nmap scripts:

    locate .nse | grep -i "http"
    
<h4>HTTP/HTTPS</h4>
Webservers

<h5>httpx</h5>

Always run HTTPx to find interesting services (https://github.com/projectdiscovery/httpx).
Create file with ip address or domain name and run the following command:

    httpx -l test.txt -sc -td -location -server

<h5>Directory and file bruteforce</h5>

    dirsearch -u http://10.10.10.10:8000/
    dirsearch -u http://10.10.10.10:8000/ -w /usr/share/wordlists/...
    dirsearch -u http://10.10.10.10:8000/ -x 404
    
    ffuf -w /usr/share/wordlists/dirb/big.txt -u http://192.168.178.22/FUZZ -e .php

<h5>Nikto</h5>

    nikto --host http://10.10.10.10/

<h4>SMB</h4>
List shares:

    nmblookup -A ip
    echo exit | smbclient -L \\\\ip
    nmap --script smb-enum-shares -p 139,445 ip
    
Check Null Sessions:

    smbmap -H ip
    rpcclient -U "" -N ip
    smbclient \\\\ip\\sharename
    
Vulns:

    nmap --script smb-vuln* -p 139,445 ip
    enum4linux -a ip

Finding version with ngrep (wireshark network tool):

<h5>Linux</h5>

    #!/bin/sh
    #Author: rewardone
    #Description:
    # Requires root or enough permissions to use tcpdump
    # Will listen for the first 7 packets of a null login
    # and grab the SMB Version
    #Notes:
    # Will sometimes not capture or will print multiple
    # lines. May need to run a second time for success.
    if [ -z $1 ]; then echo "Usage: ./smbver.sh RHOST {RPORT}" && exit; else rhost=$1; fi
    if [ ! -z $2 ]; then rport=$2; else rport=139; fi
    tcpdump -s0 -n -i tap0 src $rhost and port $rport -A -c 7 2>/dev/null | grep -i "samba\|s.a.m" | tr -d '.' | grep -oP 'UnixSamba.*[0-9a-z]' | tr -d '\n' & echo -n "$rhost: " &
    echo "exit" | smbclient -L $rhost 1>/dev/null 2>/dev/null
    sleep 0.5 && echo ""
    
    ./smbver.sh [IP]
    
<h5>Windows</h5>

Windows SMB is more complex than just a version, but looking in wireshark will give a bunch of information about the connection. We can filter on ntlmssp.ntlmv2_response to see NTLMv2 traffic, for example.

<h4>SNMP</h4>

OneSixtyOne is another tool

    onesixtyone <target> public

Bruteforce using a dict

    onesixtyone -c wordlist <target>

Or you can use snmp-check

    snmp-check -t 192.168.1.2 -c public/private

<p align="right">(<a href="#top">back to top</a>)</p>
